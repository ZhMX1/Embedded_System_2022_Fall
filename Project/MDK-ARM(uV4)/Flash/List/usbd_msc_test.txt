; generated by Component: ARM Compiler 5.06 update 4 (build 422) Tool: ArmCC [4d3604]
; commandline ArmCC [--c99 --list --split_sections --debug -c --asm --interleave -o.\flash\obj\usbd_msc_test.o --asm_dir=.\Flash\List\ --list_dir=.\Flash\List\ --depend=.\flash\obj\usbd_msc_test.d --cpu=Cortex-M3 --apcs=interwork -O3 --diag_suppress=9931,870 -I..\..\Libraries\CMSIS\Device\ST\STM32F10x\Include -I..\..\Libraries\STM32F10x_StdPeriph_Driver\inc -I..\..\Libraries\STM32_USB-FS-Device_Driver\inc -I..\..\Libraries\CMSIS\Include -I..\..\User\bsp -I..\..\User\bsp\inc -I..\..\User\app\inc -I..\..\User\fonts -I..\..\User\images -I..\..\User\uIP\uip -I..\..\User\uIP\http -I..\..\User\uIP\dm9000 -I..\..\User\FatFS\src -I..\..\User\usb_mass -I..\..\User\CH376\inc -I.\RTE\_Flash -ID:\Keil\ARM\PACK\ARM\CMSIS\5.0.1\CMSIS\Include -ID:\Keil\ARM\PACK\Keil\STM32F1xx_DFP\2.1.0\Device\Include -D__MICROLIB -D__UVISION_VERSION=523 -D_RTE_ -DSTM32F10X_HD -DUSE_STDPERIPH_DRIVER -DSTM32F10X_HD --omf_browse=.\flash\obj\usbd_msc_test.crf ..\..\User\app\src\usbd_msc_test.c]
                          THUMB

                          AREA ||i.DispUSBInitFace||, CODE, READONLY, ALIGN=2

                  DispUSBInitFace PROC
;;;528    */
;;;529    static void DispUSBInitFace(void)
000000  b510              PUSH     {r4,lr}
;;;530    {
;;;531    	LCD_ClrScr(CL_BTN_FACE);
000002  f64e705b          MOV      r0,#0xef5b
000006  f7fffffe          BL       LCD_ClrScr
;;;532    
;;;533    	/* 分组框 */
;;;534    	LCD_DrawGroupBox(&FormUSB->Box1);
00000a  4c17              LDR      r4,|L1.104|
00000c  6820              LDR      r0,[r4,#0]  ; FormUSB
00000e  3028              ADDS     r0,r0,#0x28
000010  f7fffffe          BL       LCD_DrawGroupBox
;;;535    
;;;536    	/* 标签 */
;;;537    	LCD_DrawLabel(&FormUSB->Label1);
000014  6820              LDR      r0,[r4,#0]  ; FormUSB
000016  303c              ADDS     r0,r0,#0x3c
000018  f7fffffe          BL       LCD_DrawLabel
;;;538    	LCD_DrawLabel(&FormUSB->Label2);
00001c  6820              LDR      r0,[r4,#0]  ; FormUSB
00001e  3050              ADDS     r0,r0,#0x50
000020  f7fffffe          BL       LCD_DrawLabel
;;;539    	LCD_DrawLabel(&FormUSB->Label3);
000024  6820              LDR      r0,[r4,#0]  ; FormUSB
000026  3064              ADDS     r0,r0,#0x64
000028  f7fffffe          BL       LCD_DrawLabel
;;;540    	LCD_DrawLabel(&FormUSB->Label4);
00002c  6820              LDR      r0,[r4,#0]  ; FormUSB
00002e  3078              ADDS     r0,r0,#0x78
000030  f7fffffe          BL       LCD_DrawLabel
;;;541    	LCD_DrawLabel(&FormUSB->Label5);
000034  6820              LDR      r0,[r4,#0]  ; FormUSB
000036  308c              ADDS     r0,r0,#0x8c
000038  f7fffffe          BL       LCD_DrawLabel
;;;542    	LCD_DrawLabel(&FormUSB->Label6);
00003c  6820              LDR      r0,[r4,#0]  ; FormUSB
00003e  30a0              ADDS     r0,r0,#0xa0
000040  f7fffffe          BL       LCD_DrawLabel
;;;543    
;;;544    	/* 按钮 */
;;;545    	LCD_DrawButton(&FormUSB->BtnRet);
000044  6820              LDR      r0,[r4,#0]  ; FormUSB
000046  30fc              ADDS     r0,r0,#0xfc
000048  f7fffffe          BL       LCD_DrawButton
;;;546    	LCD_DrawButton(&FormUSB->Btn1);
00004c  6820              LDR      r0,[r4,#0]  ; FormUSB
00004e  30b4              ADDS     r0,r0,#0xb4
000050  f7fffffe          BL       LCD_DrawButton
;;;547    	LCD_DrawButton(&FormUSB->Btn2);
000054  6820              LDR      r0,[r4,#0]  ; FormUSB
000056  30cc              ADDS     r0,r0,#0xcc
000058  f7fffffe          BL       LCD_DrawButton
;;;548    	LCD_DrawButton(&FormUSB->Btn3);
00005c  6820              LDR      r0,[r4,#0]  ; FormUSB
00005e  e8bd4010          POP      {r4,lr}
000062  30e4              ADDS     r0,r0,#0xe4
000064  f7ffbffe          B.W      LCD_DrawButton
;;;549    }
;;;550    
                          ENDP

                  |L1.104|
                          DCD      ||.data||

                          AREA ||i.InitFormUSB||, CODE, READONLY, ALIGN=2

                  InitFormUSB PROC
;;;408    */
;;;409    static void InitFormUSB(void)
000000  b5f0              PUSH     {r4-r7,lr}
;;;410    {
;;;411    	/* 分组框标题字体 */
;;;412    	FormUSB->FontBox.FontCode = FC_ST_16;
000002  4857              LDR      r0,|L2.352|
000004  2101              MOVS     r1,#1
;;;413    	FormUSB->FontBox.BackColor = CL_BTN_FACE;	/* 和背景色相同 */
000006  f64e725b          MOV      r2,#0xef5b
00000a  6800              LDR      r0,[r0,#0]            ;412  ; FormUSB
;;;414    	FormUSB->FontBox.FrontColor = CL_BLACK;
00000c  2300              MOVS     r3,#0
;;;415    	FormUSB->FontBox.Space = 0;
;;;416    
;;;417    	/* 字体1 用于静止标签 */
;;;418    	FormUSB->FontBlack.FontCode = FC_ST_16;
;;;419    	FormUSB->FontBlack.BackColor = CL_MASK;		/* 透明色 */
;;;420    	FormUSB->FontBlack.FrontColor = CL_BLACK;
00000e  2400              MOVS     r4,#0
000010  f8801020          STRB     r1,[r0,#0x20]         ;412
000014  8482              STRH     r2,[r0,#0x24]         ;413
000016  8443              STRH     r3,[r0,#0x22]         ;414
000018  84c3              STRH     r3,[r0,#0x26]         ;415
00001a  7001              STRB     r1,[r0,#0]            ;418
00001c  f6491399          MOV      r3,#0x9999            ;419
000020  8083              STRH     r3,[r0,#4]            ;419
000022  8044              STRH     r4,[r0,#2]
;;;421    	FormUSB->FontBlack.Space = 0;
000024  80c4              STRH     r4,[r0,#6]
;;;422    
;;;423    	/* 字体2 用于变化的文字 */
;;;424    	FormUSB->FontBlue.FontCode = FC_ST_16;
000026  7201              STRB     r1,[r0,#8]
;;;425    	FormUSB->FontBlue.BackColor = CL_BTN_FACE;
000028  8182              STRH     r2,[r0,#0xc]
;;;426    	FormUSB->FontBlue.FrontColor = CL_BLUE;
00002a  241f              MOVS     r4,#0x1f
00002c  8144              STRH     r4,[r0,#0xa]
;;;427    	FormUSB->FontBlue.Space = 0;
00002e  2400              MOVS     r4,#0
000030  81c4              STRH     r4,[r0,#0xe]
;;;428    
;;;429    	/* 字体3 用于变化的文字 */
;;;430    	FormUSB->FontRed.FontCode = FC_ST_16;
000032  7401              STRB     r1,[r0,#0x10]
;;;431    	FormUSB->FontRed.BackColor = CL_BTN_FACE;
000034  8282              STRH     r2,[r0,#0x14]
;;;432    	FormUSB->FontRed.FrontColor = CL_RED;
000036  f44f4278          MOV      r2,#0xf800
00003a  8242              STRH     r2,[r0,#0x12]
;;;433    	FormUSB->FontRed.Space = 0;
00003c  82c4              STRH     r4,[r0,#0x16]
;;;434    
;;;435    	/* 按钮字体 */
;;;436    	FormUSB->FontBtn.FontCode = FC_ST_16;
00003e  7601              STRB     r1,[r0,#0x18]
;;;437    	FormUSB->FontBtn.BackColor = CL_MASK;		/* 透明背景 */
000040  8383              STRH     r3,[r0,#0x1c]
;;;438    	FormUSB->FontBtn.FrontColor = CL_BLACK;
000042  8344              STRH     r4,[r0,#0x1a]
;;;439    	FormUSB->FontBtn.Space = 0;
000044  83c4              STRH     r4,[r0,#0x1e]
;;;440    
;;;441    	/* 分组框 */
;;;442    	FormUSB->Box1.Left = BOX1_X;
000046  2105              MOVS     r1,#5
000048  8541              STRH     r1,[r0,#0x2a]
;;;443    	FormUSB->Box1.Top = BOX1_Y;
00004a  2108              MOVS     r1,#8
00004c  8581              STRH     r1,[r0,#0x2c]
;;;444    	FormUSB->Box1.Height = BOX1_H;
00004e  4945              LDR      r1,|L2.356|
;;;445    	FormUSB->Box1.Width = BOX1_W;
;;;446    	FormUSB->Box1.pCaption = BOX1_TEXT;
;;;447    	FormUSB->Box1.Font = &FormUSB->FontBox;
;;;448    
;;;449    	/* 静态标签 */
;;;450    	FormUSB->Label1.Left = LABEL1_X;
;;;451    	FormUSB->Label1.Top = LABEL1_Y;
000050  261c              MOVS     r6,#0x1c
;;;452    	FormUSB->Label1.MaxLen = 0;
;;;453    	FormUSB->Label1.pCaption = LABEL1_TEXT;
;;;454    	FormUSB->Label1.Font = &FormUSB->FontBlack;
;;;455    
;;;456    	FormUSB->Label3.Left = LABEL3_X;
;;;457    	FormUSB->Label3.Top = LABEL3_Y;
000052  2530              MOVS     r5,#0x30
000054  8809              LDRH     r1,[r1,#0]            ;444  ; g_LcdHeight
;;;458    	FormUSB->Label3.MaxLen = 0;
;;;459    	FormUSB->Label3.pCaption = LABEL3_TEXT;
;;;460    	FormUSB->Label3.Font = &FormUSB->FontBlack;
;;;461    
;;;462    	FormUSB->Label5.Left = LABEL5_X;
;;;463    	FormUSB->Label5.Top = LABEL5_Y;
000056  2744              MOVS     r7,#0x44
000058  f1a10212          SUB      r2,r1,#0x12           ;444
00005c  85c2              STRH     r2,[r0,#0x2e]         ;444
00005e  4a42              LDR      r2,|L2.360|
000060  8813              LDRH     r3,[r2,#0]            ;445  ; g_LcdWidth
000062  f1a3020a          SUB      r2,r3,#0xa            ;445
000066  8602              STRH     r2,[r0,#0x30]         ;445
000068  a240              ADR      r2,|L2.364|
00006a  6382              STR      r2,[r0,#0x38]         ;447
00006c  f1000220          ADD      r2,r0,#0x20           ;447
000070  6342              STR      r2,[r0,#0x34]         ;450
000072  220b              MOVS     r2,#0xb               ;450
000074  87c2              STRH     r2,[r0,#0x3e]         ;450
000076  f8a06040          STRH     r6,[r0,#0x40]         ;451
00007a  f8a04046          STRH     r4,[r0,#0x46]         ;452
00007e  a441              ADR      r4,|L2.388|
000080  e9c00412          STRD     r0,r4,[r0,#0x48]      ;453
000084  f8a02066          STRH     r2,[r0,#0x66]         ;456
000088  f8a05068          STRH     r5,[r0,#0x68]         ;457
00008c  2400              MOVS     r4,#0                 ;458
00008e  f8a0406e          STRH     r4,[r0,#0x6e]         ;458
000092  a43f              ADR      r4,|L2.400|
000094  e9c0041c          STRD     r0,r4,[r0,#0x70]      ;459
000098  f8a0208e          STRH     r2,[r0,#0x8e]         ;462
00009c  f8a07090          STRH     r7,[r0,#0x90]
;;;464    	FormUSB->Label5.MaxLen = 0;
0000a0  2200              MOVS     r2,#0
0000a2  f8a02096          STRH     r2,[r0,#0x96]
;;;465    	FormUSB->Label5.pCaption = LABEL5_TEXT;
0000a6  a23d              ADR      r2,|L2.412|
;;;466    	FormUSB->Label5.Font = &FormUSB->FontBlack;
0000a8  e9c00226          STRD     r0,r2,[r0,#0x98]
;;;467    
;;;468    	/* 动态标签 */
;;;469    	FormUSB->Label2.Left = LABEL2_X;
0000ac  246f              MOVS     r4,#0x6f
0000ae  f8a04052          STRH     r4,[r0,#0x52]
;;;470    	FormUSB->Label2.Top = LABEL2_Y;
0000b2  f8a06054          STRH     r6,[r0,#0x54]
;;;471    	FormUSB->Label2.MaxLen = 0;
0000b6  2200              MOVS     r2,#0
0000b8  f8a0205a          STRH     r2,[r0,#0x5a]
;;;472    	FormUSB->Label2.pCaption = LABEL2_TEXT;
0000bc  a23a              ADR      r2,|L2.424|
0000be  f8402f60          STR      r2,[r0,#0x60]!
;;;473    	FormUSB->Label2.Font = &FormUSB->FontBlue;
0000c2  f1a00258          SUB      r2,r0,#0x58
0000c6  f8402c04          STR      r2,[r0,#-4]
;;;474    
;;;475    	FormUSB->Label4.Left = LABEL4_X;
0000ca  8344              STRH     r4,[r0,#0x1a]
;;;476    	FormUSB->Label4.Top = LABEL4_Y;
0000cc  8385              STRH     r5,[r0,#0x1c]
;;;477    	FormUSB->Label4.MaxLen = 0;
0000ce  2500              MOVS     r5,#0
0000d0  8445              STRH     r5,[r0,#0x22]
;;;478    	FormUSB->Label4.pCaption = LABEL4_TEXT;
0000d2  a535              ADR      r5,|L2.424|
0000d4  e9c02509          STRD     r2,r5,[r0,#0x24]
;;;479    	FormUSB->Label4.Font = &FormUSB->FontBlue;
;;;480    
;;;481    	FormUSB->Label6.Left = LABEL6_X;
0000d8  f8a04042          STRH     r4,[r0,#0x42]
;;;482    	FormUSB->Label6.Top = LABEL6_Y;
0000dc  f8a07044          STRH     r7,[r0,#0x44]
;;;483    	FormUSB->Label6.MaxLen = 0;
0000e0  2400              MOVS     r4,#0
0000e2  f8a0404a          STRH     r4,[r0,#0x4a]
;;;484    	FormUSB->Label6.pCaption = LABEL6_TEXT;
0000e6  a430              ADR      r4,|L2.424|
;;;485    	FormUSB->Label6.Font = &FormUSB->FontBlue;
;;;486    
;;;487    	/* 按钮 */
;;;488    	FormUSB->BtnRet.Left = BTN_RET_X;
0000e8  e9c02413          STRD     r2,r4,[r0,#0x4c]
0000ec  3b45              SUBS     r3,r3,#0x45           ;485
0000ee  f8a0309e          STRH     r3,[r0,#0x9e]
0000f2  392e              SUBS     r1,r1,#0x2e
;;;489    	FormUSB->BtnRet.Top = BTN_RET_Y;
0000f4  f8a010a0          STRH     r1,[r0,#0xa0]
;;;490    	FormUSB->BtnRet.Height = BTN_RET_H;
0000f8  2220              MOVS     r2,#0x20
0000fa  f8a020a2          STRH     r2,[r0,#0xa2]
;;;491    	FormUSB->BtnRet.Width = BTN_RET_W;
0000fe  213c              MOVS     r1,#0x3c
000100  f8a010a4          STRH     r1,[r0,#0xa4]
;;;492    	FormUSB->BtnRet.pCaption = BTN_RET_TEXT;
000104  a129              ADR      r1,|L2.428|
;;;493    	FormUSB->BtnRet.Font = &FormUSB->FontBtn;
000106  f8c010ac          STR      r1,[r0,#0xac]
00010a  f1a00148          SUB      r1,r0,#0x48
;;;494    	FormUSB->BtnRet.Focus = 0;
00010e  2300              MOVS     r3,#0
000110  f8c010a8          STR      r1,[r0,#0xa8]
000114  f88030b0          STRB     r3,[r0,#0xb0]
;;;495    
;;;496    	FormUSB->Btn1.Left = BTN1_X;
000118  230a              MOVS     r3,#0xa
00011a  f8a03056          STRH     r3,[r0,#0x56]
;;;497    	FormUSB->Btn1.Top = BTN1_Y;
00011e  246c              MOVS     r4,#0x6c
000120  f8204f58          STRH     r4,[r0,#0x58]!
;;;498    	FormUSB->Btn1.Height = BTN1_H;
;;;499    	FormUSB->Btn1.Width = BTN1_W;
000124  2564              MOVS     r5,#0x64
000126  8042              STRH     r2,[r0,#2]            ;498
000128  8085              STRH     r5,[r0,#4]
;;;500    	FormUSB->Btn1.pCaption = BTN1_TEXT;
00012a  a622              ADR      r6,|L2.436|
00012c  e9c01602          STRD     r1,r6,[r0,#8]
;;;501    	FormUSB->Btn1.Font = &FormUSB->FontBtn;
;;;502    	FormUSB->Btn1.Focus = 0;
000130  2600              MOVS     r6,#0
000132  7406              STRB     r6,[r0,#0x10]
;;;503    
;;;504    	FormUSB->Btn2.Left = BTN2_X;
000134  2678              MOVS     r6,#0x78
000136  82c6              STRH     r6,[r0,#0x16]
;;;505    	FormUSB->Btn2.Top = BTN2_Y;
000138  8304              STRH     r4,[r0,#0x18]
;;;506    	FormUSB->Btn2.Height = BTN2_H;
00013a  8342              STRH     r2,[r0,#0x1a]
;;;507    	FormUSB->Btn2.Width = BTN2_W;
00013c  8385              STRH     r5,[r0,#0x1c]
;;;508    	FormUSB->Btn2.pCaption = BTN2_TEXT;
00013e  a420              ADR      r4,|L2.448|
000140  e9c01408          STRD     r1,r4,[r0,#0x20]
;;;509    	FormUSB->Btn2.Font = &FormUSB->FontBtn;
;;;510    	FormUSB->Btn2.Focus = 0;
000144  2400              MOVS     r4,#0
000146  f8804028          STRB     r4,[r0,#0x28]
;;;511    
;;;512    	FormUSB->Btn3.Left = BTN3_X;
00014a  85c3              STRH     r3,[r0,#0x2e]
;;;513    	FormUSB->Btn3.Top = BTN3_Y;
00014c  2396              MOVS     r3,#0x96
00014e  8603              STRH     r3,[r0,#0x30]
;;;514    	FormUSB->Btn3.Height = BTN3_H;
000150  8642              STRH     r2,[r0,#0x32]
;;;515    	FormUSB->Btn3.Width = BTN3_W;
000152  8686              STRH     r6,[r0,#0x34]
;;;516    	FormUSB->Btn3.pCaption = BTN3_TEXT;
000154  a21d              ADR      r2,|L2.460|
000156  e9c0120e          STRD     r1,r2,[r0,#0x38]
;;;517    	FormUSB->Btn3.Font = &FormUSB->FontBtn;
;;;518    	FormUSB->Btn3.Focus = 0;
00015a  f8804040          STRB     r4,[r0,#0x40]
;;;519    }
00015e  bdf0              POP      {r4-r7,pc}
;;;520    
                          ENDP

                  |L2.352|
                          DCD      ||.data||
                  |L2.356|
                          DCD      g_LcdHeight
                  |L2.360|
                          DCD      g_LcdWidth
                  |L2.364|
00016c  5344bfa8          DCB      "SD",191,168,186,205,"NAND Flash",196,163,196,226,"U",197
000170  bacd4e41
000174  4e442046
000178  6c617368
00017c  c4a3c4e2
000180  55c5    
000182  cc00              DCB      204,0
                  |L2.388|
000184  5344bfa8          DCB      "SD",191,168,215,180,204,172," : ",0
000188  d7b4ccac
00018c  203a2000
                  |L2.400|
000190  4e414e44          DCB      "NAND",215,180,204,172," : ",0
000194  d7b4ccac
000198  203a2000
                  |L2.412|
00019c  55534244          DCB      "USBD",215,180,204,172," : ",0
0001a0  d7b4ccac
0001a4  203a2000
                  |L2.424|
0001a8  2d2d00            DCB      "--",0
0001ab  00                DCB      0
                  |L2.428|
0001ac  b7b5bbd8          DCB      183,181,187,216,0
0001b0  00      
0001b1  00                DCB      0
0001b2  00                DCB      0
0001b3  00                DCB      0
                  |L2.436|
0001b4  b4f2bfaa          DCB      180,242,191,170,196,163,196,226,"U",197,204,0
0001b8  c4a3c4e2
0001bc  55c5cc00
                  |L2.448|
0001c0  b9d8b1d5          DCB      185,216,177,213,196,163,196,226,"U",197,204,0
0001c4  c4a3c4e2
0001c8  55c5cc00
                  |L2.460|
0001cc  b5cdb8f1          DCB      181,205,184,241,"NAND Flash",0
0001d0  4e414e44
0001d4  20466c61
0001d8  736800  
0001db  00                DCB      0

                          AREA ||i.TestUsbdMsc||, CODE, READONLY, ALIGN=2

                          REQUIRE _printf_percent
                          REQUIRE _printf_d
                          REQUIRE _printf_s
                          REQUIRE _printf_int_dec
                          REQUIRE _printf_str
                  TestUsbdMsc PROC
;;;115    */
;;;116    void TestUsbdMsc(void)
000000  e92d4ff0          PUSH     {r4-r11,lr}
;;;117    {
;;;118    	uint8_t ucKeyCode;		/* 按键代码 */
;;;119    	uint8_t ucTouch;		/* 触摸事件 */
;;;120    	uint8_t fQuit = 0;
;;;121    	int16_t tpX, tpY;
;;;122    	uint8_t ucNandOk;
;;;123    	uint8_t ucCardOk;
;;;124    	uint8_t ucUsbOk;
;;;125    	FormUSB_T form;
;;;126    	uint8_t fRefresh;
;;;127    	NAND_BLOCK_INFO_T nand;	
;;;128    	char buf[64];
;;;129    
;;;130    	FormUSB = &form;
000004  4ce6              LDR      r4,|L3.928|
000006  b0eb              SUB      sp,sp,#0x1ac          ;117
000008  a812              ADD      r0,sp,#0x48
00000a  2700              MOVS     r7,#0                 ;120
;;;131    
;;;132    	InitFormUSB();
00000c  6020              STR      r0,[r4,#0]  ; FormUSB
00000e  f7fffffe          BL       InitFormUSB
;;;133    	DispUSBInitFace();
000012  f7fffffe          BL       DispUSBInitFace
;;;134    
;;;135    	{
;;;136    			
;;;137    		NAND_DispBadBlockInfo();	/* 向串口1打印NAND Flash坏块信息 (此函数开头初始FSMC) */
000016  f7fffffe          BL       NAND_DispBadBlockInfo
;;;138    
;;;139    		/* 配置FSMC用于NAND Flash， 复位NAND Flash，重建LUT表 */
;;;140    		if (NAND_Init() == NAND_OK)
00001a  f7fffffe          BL       NAND_Init
00001e  2800              CMP      r0,#0
000020  d016              BEQ      |L3.80|
;;;141    		{
;;;142    			printf("NAND_Init() Ok\r\n");
;;;143    			ucNandOk = 1;
;;;144    		}
;;;145    		else
;;;146    		{
;;;147    			/* 建议在正式的产品中采用人为干预的方式启动低级格式化 */
;;;148    			/* 自动检测nand flash是否进行了低级格式化，如果没有则执行格式化（2秒） */
;;;149    			printf("NAND_Init() Error! \r\n");
000022  a0e0              ADR      r0,|L3.932|
000024  f7fffffe          BL       __2printf
;;;150    			printf("Start Format(Low Level) NAND Flash......\r\n");
000028  a0e4              ADR      r0,|L3.956|
00002a  f7fffffe          BL       __2printf
;;;151    			NAND_Format();
00002e  f7fffffe          BL       NAND_Format
;;;152    			printf("NAND Flash Format Ok\r\n");
000032  a0ed              ADR      r0,|L3.1000|
                  |L3.52|
000034  f7fffffe          BL       __2printf
;;;153    
;;;154    			ucNandOk = 1;
000038  2601              MOVS     r6,#1
;;;155    		}
;;;156    
;;;157    		if (NAND_GetBlockInfo(&nand) == 1)
00003a  a85c              ADD      r0,sp,#0x170
00003c  f7fffffe          BL       NAND_GetBlockInfo
000040  2801              CMP      r0,#1
000042  d000              BEQ      |L3.70|
;;;158    		{
;;;159    			ucNandOk = 1;
;;;160    		}
;;;161    		else
;;;162    		{
;;;163    			ucNandOk = 0;
000044  2600              MOVS     r6,#0
                  |L3.70|
;;;164    		}
;;;165    
;;;166    		if (SD_Init() != SD_OK)
000046  f7fffffe          BL       SD_Init
00004a  b118              CBZ      r0,|L3.84|
;;;167    		{
;;;168    			ucCardOk = 0;
00004c  2500              MOVS     r5,#0
00004e  e002              B        |L3.86|
                  |L3.80|
000050  a0eb              ADR      r0,|L3.1024|
000052  e7ef              B        |L3.52|
                  |L3.84|
;;;169    		}
;;;170    		else
;;;171    		{
;;;172    			ucCardOk = 1;
000054  2501              MOVS     r5,#1
                  |L3.86|
;;;173    		}
;;;174    	}
;;;175    
;;;176    	ucUsbOk = 1;
000056  f04f0a01          MOV      r10,#1
;;;177    //	usbd_OpenMassStorage();		/* 初始化USB Device，配置为Mass Storage */
;;;178    	
;;;179    	InitUsbDev();	/* 初始化USB设备 */
00005a  f7fffffe          BL       InitUsbDev
;;;180    
;;;181    	fRefresh = 1;
;;;182    
;;;183    	/* 进入主程序循环体 */
;;;184    	while (fQuit == 0)
;;;185    	{
;;;186    		bsp_Idle();
00005e  f7fffffe          BL       bsp_Idle
000062  46a1              MOV      r9,r4                 ;130
000064  e005              B        |L3.114|
000066  bf00              NOP      
                  |L3.104|
000068  f7fffffe          BL       bsp_Idle
;;;187    
;;;188    		if (fRefresh)
00006c  f1b80f00          CMP      r8,#0
000070  d04f              BEQ      |L3.274|
                  |L3.114|
;;;189    		{
;;;190    			fRefresh = 0;
;;;191    
;;;192    			if (ucCardOk)
000072  f8d90000          LDR      r0,[r9,#0]  ; FormUSB
000076  f04f0800          MOV      r8,#0                 ;190
00007a  b125              CBZ      r5,|L3.134|
;;;193    			{
;;;194    				FormUSB->Label2.Font = &FormUSB->FontBlue;
00007c  f1000108          ADD      r1,r0,#8
;;;195    				FormUSB->Label2.pCaption = "Ok ";
000080  65c1              STR      r1,[r0,#0x5c]
000082  a1e4              ADR      r1,|L3.1044|
000084  e003              B        |L3.142|
                  |L3.134|
;;;196    			}
;;;197    			else
;;;198    			{
;;;199    				FormUSB->Label2.Font = &FormUSB->FontRed;
000086  f1000110          ADD      r1,r0,#0x10
;;;200    				FormUSB->Label2.pCaption = "Err";
00008a  65c1              STR      r1,[r0,#0x5c]
00008c  a1e2              ADR      r1,|L3.1048|
                  |L3.142|
;;;201    			}
;;;202    			LCD_DrawLabel(&FormUSB->Label2);
00008e  6601              STR      r1,[r0,#0x60]
000090  f8d90000          LDR      r0,[r9,#0]  ; FormUSB
000094  464c              MOV      r4,r9
000096  3050              ADDS     r0,r0,#0x50
000098  f7fffffe          BL       LCD_DrawLabel
;;;203    
;;;204    			if (ucNandOk)
00009c  b1ce              CBZ      r6,|L3.210|
;;;205    			{
;;;206    				FormUSB->Label4.pCaption = buf;
00009e  6821              LDR      r1,[r4,#0]  ; FormUSB
0000a0  a802              ADD      r0,sp,#8
;;;207    				sprintf(buf, "OK, %s, Bad=%d, Used=%d, Free=%d", nand.ChipName, nand.Bad, nand.Used, nand.Free);
0000a2  aa5d              ADD      r2,sp,#0x174
0000a4  f8c10088          STR      r0,[r1,#0x88]         ;206
0000a8  e9dd1062          LDRD     r1,r0,[sp,#0x188]     ;206
0000ac  e9cd0100          STRD     r0,r1,[sp,#0]         ;206
0000b0  a1da              ADR      r1,|L3.1052|
0000b2  a802              ADD      r0,sp,#8
0000b4  9b61              LDR      r3,[sp,#0x184]
0000b6  f7fffffe          BL       __2sprintf
;;;208    				
;;;209    				if (nand.Bad > 5)
0000ba  9861              LDR      r0,[sp,#0x184]
0000bc  2805              CMP      r0,#5
0000be  6820              LDR      r0,[r4,#0]  ; FormUSB
0000c0  d902              BLS      |L3.200|
;;;210    				{
;;;211    					/* 如果坏块个数大于5个，则显示红色 */
;;;212    					FormUSB->Label4.Font = &FormUSB->FontRed;
0000c2  f1000110          ADD      r1,r0,#0x10
0000c6  e001              B        |L3.204|
                  |L3.200|
;;;213    				}
;;;214    				else
;;;215    				{
;;;216    					/* 坏块数量在正常范围内，显示蓝色 */
;;;217    					FormUSB->Label4.Font = &FormUSB->FontBlue;
0000c8  f1000108          ADD      r1,r0,#8
                  |L3.204|
0000cc  f8c01084          STR      r1,[r0,#0x84]         ;212
0000d0  e006              B        |L3.224|
                  |L3.210|
;;;218    				}
;;;219    			}
;;;220    			else
;;;221    			{
;;;222    				FormUSB->Label4.Font = &FormUSB->FontRed;
0000d2  6820              LDR      r0,[r4,#0]  ; FormUSB
0000d4  f1000110          ADD      r1,r0,#0x10
0000d8  f8401f84          STR      r1,[r0,#0x84]!
;;;223    				FormUSB->Label4.pCaption = "Err";
0000dc  a1ce              ADR      r1,|L3.1048|
0000de  6041              STR      r1,[r0,#4]
                  |L3.224|
;;;224    			}
;;;225    			LCD_DrawLabel(&FormUSB->Label4);
0000e0  6820              LDR      r0,[r4,#0]  ; FormUSB
0000e2  3078              ADDS     r0,r0,#0x78
0000e4  f7fffffe          BL       LCD_DrawLabel
;;;226    
;;;227    			if (ucUsbOk)
0000e8  6820              LDR      r0,[r4,#0]  ; FormUSB
0000ea  f1ba0f00          CMP      r10,#0
0000ee  d005              BEQ      |L3.252|
;;;228    			{
;;;229    				FormUSB->Label6.Font = &FormUSB->FontBlue;
0000f0  f1000108          ADD      r1,r0,#8
0000f4  f8401fac          STR      r1,[r0,#0xac]!
;;;230    				FormUSB->Label6.pCaption = "已打开 ";
0000f8  a1d1              ADR      r1,|L3.1088|
0000fa  e004              B        |L3.262|
                  |L3.252|
;;;231    			}
;;;232    			else
;;;233    			{
;;;234    				FormUSB->Label6.Font = &FormUSB->FontRed;
0000fc  f1000110          ADD      r1,r0,#0x10
000100  f8401fac          STR      r1,[r0,#0xac]!
;;;235    				FormUSB->Label6.pCaption = "已关闭";
000104  a1d0              ADR      r1,|L3.1096|
                  |L3.262|
;;;236    			}
;;;237    			LCD_DrawLabel(&FormUSB->Label6);
000106  6041              STR      r1,[r0,#4]
000108  6820              LDR      r0,[r4,#0]  ; FormUSB
00010a  46a1              MOV      r9,r4
00010c  30a0              ADDS     r0,r0,#0xa0
00010e  f7fffffe          BL       LCD_DrawLabel
                  |L3.274|
;;;238    		}
;;;239    
;;;240    		ucTouch = TOUCH_GetKey(&tpX, &tpY);	/* 读取触摸事件 */
000112  a95b              ADD      r1,sp,#0x16c
000114  a864              ADD      r0,sp,#0x190
000116  f7fffffe          BL       TOUCH_GetKey
;;;241    		if (ucTouch != TOUCH_NONE)
00011a  2800              CMP      r0,#0
                  |L3.284|
00011c  d039              BEQ      |L3.402|
;;;242    		{
;;;243    			switch (ucTouch)
00011e  2801              CMP      r0,#1
000120  d004              BEQ      |L3.300|
000122  2802              CMP      r0,#2
000124  d0fa              BEQ      |L3.284|
000126  2803              CMP      r0,#3
000128  d133              BNE      |L3.402|
00012a  e05c              B        |L3.486|
                  |L3.300|
;;;244    			{
;;;245    				case TOUCH_DOWN:		/* 触笔按下事件 */
;;;246    					if (TOUCH_InRect(tpX, tpY, BTN_RET_X, BTN_RET_Y, BTN_RET_H, BTN_RET_W))
00012c  213c              MOVS     r1,#0x3c
00012e  f04f0b20          MOV      r11,#0x20
000132  48c7              LDR      r0,|L3.1104|
000134  e9cdb100          STRD     r11,r1,[sp,#0]
000138  8800              LDRH     r0,[r0,#0]  ; g_LcdHeight
00013a  382e              SUBS     r0,r0,#0x2e
00013c  b283              UXTH     r3,r0
00013e  48c5              LDR      r0,|L3.1108|
000140  8800              LDRH     r0,[r0,#0]  ; g_LcdWidth
000142  3845              SUBS     r0,r0,#0x45
000144  b282              UXTH     r2,r0
000146  f8bd016c          LDRH     r0,[sp,#0x16c]
00014a  b281              UXTH     r1,r0
00014c  f8bd0190          LDRH     r0,[sp,#0x190]
000150  b280              UXTH     r0,r0
000152  f7fffffe          BL       TOUCH_InRect
000156  b130              CBZ      r0,|L3.358|
;;;247    					{
;;;248    						FormUSB->BtnRet.Focus = 1;
000158  f8d90000          LDR      r0,[r9,#0]  ; FormUSB
00015c  2101              MOVS     r1,#1
00015e  f8801110          STRB     r1,[r0,#0x110]
000162  30fc              ADDS     r0,r0,#0xfc
;;;249    						LCD_DrawButton(&FormUSB->BtnRet);
000164  e013              B        |L3.398|
                  |L3.358|
;;;250    					}
;;;251    					else if (TOUCH_InRect(tpX, tpY, BTN1_X, BTN1_Y, BTN1_H, BTN1_W))
000166  2464              MOVS     r4,#0x64
000168  e9cdb400          STRD     r11,r4,[sp,#0]
00016c  f8bd016c          LDRH     r0,[sp,#0x16c]
000170  236c              MOVS     r3,#0x6c
000172  b281              UXTH     r1,r0
000174  f8bd0190          LDRH     r0,[sp,#0x190]
000178  220a              MOVS     r2,#0xa
00017a  b280              UXTH     r0,r0
00017c  f7fffffe          BL       TOUCH_InRect
000180  b140              CBZ      r0,|L3.404|
;;;252    					{
;;;253    						FormUSB->Btn1.Focus = 1;
000182  f8d90000          LDR      r0,[r9,#0]  ; FormUSB
000186  2101              MOVS     r1,#1
000188  f88010c8          STRB     r1,[r0,#0xc8]
00018c  30b4              ADDS     r0,r0,#0xb4
                  |L3.398|
00018e  f7fffffe          BL       LCD_DrawButton
                  |L3.402|
000192  e0a8              B        |L3.742|
                  |L3.404|
000194  e9cdb400          STRD     r11,r4,[sp,#0]        ;249
;;;254    						LCD_DrawButton(&FormUSB->Btn1);
;;;255    					}
;;;256    					else if (TOUCH_InRect(tpX, tpY, BTN2_X, BTN2_Y, BTN2_H, BTN2_W))
000198  f8bd016c          LDRH     r0,[sp,#0x16c]
00019c  236c              MOVS     r3,#0x6c
00019e  b281              UXTH     r1,r0
0001a0  f8bd0190          LDRH     r0,[sp,#0x190]
0001a4  2278              MOVS     r2,#0x78
0001a6  b280              UXTH     r0,r0
0001a8  f7fffffe          BL       TOUCH_InRect
0001ac  b128              CBZ      r0,|L3.442|
;;;257    					{
;;;258    						FormUSB->Btn2.Focus = 1;
0001ae  f8d90000          LDR      r0,[r9,#0]  ; FormUSB
0001b2  2101              MOVS     r1,#1
0001b4  f88010e0          STRB     r1,[r0,#0xe0]
;;;259    						LCD_DrawButton(&FormUSB->Btn2);
0001b8  e0b7              B        |L3.810|
                  |L3.442|
;;;260    					}
;;;261    					else if (TOUCH_InRect(tpX, tpY, BTN3_X, BTN3_Y, BTN3_H, BTN3_W))
0001ba  2078              MOVS     r0,#0x78
0001bc  e9cdb000          STRD     r11,r0,[sp,#0]
0001c0  f8bd016c          LDRH     r0,[sp,#0x16c]
0001c4  2396              MOVS     r3,#0x96
0001c6  b281              UXTH     r1,r0
0001c8  f8bd0190          LDRH     r0,[sp,#0x190]
0001cc  220a              MOVS     r2,#0xa
0001ce  b280              UXTH     r0,r0
0001d0  f7fffffe          BL       TOUCH_InRect
0001d4  2800              CMP      r0,#0
0001d6  d024              BEQ      |L3.546|
;;;262    					{
;;;263    						FormUSB->Btn3.Focus = 1;
0001d8  f8d90000          LDR      r0,[r9,#0]  ; FormUSB
0001dc  2101              MOVS     r1,#1
0001de  f88010f8          STRB     r1,[r0,#0xf8]
0001e2  30e4              ADDS     r0,r0,#0xe4
;;;264    						LCD_DrawButton(&FormUSB->Btn3);
0001e4  e7d3              B        |L3.398|
                  |L3.486|
;;;265    					}					
;;;266    					break;
;;;267    
;;;268    				case TOUCH_MOVE:		/* 触笔移动事件 */
;;;269    					break;
;;;270    
;;;271    				case TOUCH_RELEASE:		/* 触笔释放事件 */
;;;272    					if (TOUCH_InRect(tpX, tpY, BTN_RET_X, BTN_RET_Y, BTN_RET_H, BTN_RET_W))
0001e6  203c              MOVS     r0,#0x3c
0001e8  2420              MOVS     r4,#0x20
0001ea  e9cd4000          STRD     r4,r0,[sp,#0]
0001ee  4898              LDR      r0,|L3.1104|
0001f0  8800              LDRH     r0,[r0,#0]  ; g_LcdHeight
0001f2  382e              SUBS     r0,r0,#0x2e
0001f4  b283              UXTH     r3,r0
0001f6  4897              LDR      r0,|L3.1108|
0001f8  8800              LDRH     r0,[r0,#0]  ; g_LcdWidth
0001fa  3845              SUBS     r0,r0,#0x45
0001fc  b282              UXTH     r2,r0
0001fe  f8bd016c          LDRH     r0,[sp,#0x16c]
000202  b281              UXTH     r1,r0
000204  f8bd0190          LDRH     r0,[sp,#0x190]
000208  b280              UXTH     r0,r0
00020a  f7fffffe          BL       TOUCH_InRect
00020e  b148              CBZ      r0,|L3.548|
;;;273    					{
;;;274    						FormUSB->BtnRet.Focus = 0;
000210  f8d90000          LDR      r0,[r9,#0]  ; FormUSB
000214  2100              MOVS     r1,#0
000216  f8801110          STRB     r1,[r0,#0x110]
00021a  30fc              ADDS     r0,r0,#0xfc
;;;275    						LCD_DrawButton(&FormUSB->BtnRet);
00021c  f7fffffe          BL       LCD_DrawButton
;;;276    						fQuit = 1;	/* 返回 */
000220  2701              MOVS     r7,#1
                  |L3.546|
000222  e060              B        |L3.742|
                  |L3.548|
;;;277    					}
;;;278    					else if (TOUCH_InRect(tpX, tpY, BTN1_X, BTN1_Y, BTN1_H, BTN1_W))
000224  f04f0b64          MOV      r11,#0x64
000228  e9cd4b00          STRD     r4,r11,[sp,#0]
00022c  f8bd016c          LDRH     r0,[sp,#0x16c]
000230  236c              MOVS     r3,#0x6c
000232  b281              UXTH     r1,r0
000234  f8bd0190          LDRH     r0,[sp,#0x190]
000238  220a              MOVS     r2,#0xa
00023a  b280              UXTH     r0,r0
00023c  f7fffffe          BL       TOUCH_InRect
000240  b190              CBZ      r0,|L3.616|
;;;279    					{
;;;280    						FormUSB->Btn1.Focus = 0;
000242  f8d90000          LDR      r0,[r9,#0]  ; FormUSB
000246  2100              MOVS     r1,#0
000248  f88010c8          STRB     r1,[r0,#0xc8]
00024c  30b4              ADDS     r0,r0,#0xb4
;;;281    						LCD_DrawButton(&FormUSB->Btn1);
00024e  f7fffffe          BL       LCD_DrawButton
;;;282    
;;;283    						if (SD_Init() != 0)
000252  f7fffffe          BL       SD_Init
000256  b108              CBZ      r0,|L3.604|
;;;284    						{
;;;285    							ucCardOk = 0;
000258  2500              MOVS     r5,#0
00025a  e000              B        |L3.606|
                  |L3.604|
;;;286    						}
;;;287    						else
;;;288    						{
;;;289    							ucCardOk = 1;
00025c  2501              MOVS     r5,#1
                  |L3.606|
;;;290    						}
;;;291    						USB_Cable_Config(ENABLE);	/* 打开U盘 */
00025e  2001              MOVS     r0,#1
000260  f7fffffe          BL       USB_Cable_Config
;;;292    						ucUsbOk = 1;
000264  2001              MOVS     r0,#1
;;;293    						fRefresh = 1;
000266  e018              B        |L3.666|
                  |L3.616|
000268  e9cd4b00          STRD     r4,r11,[sp,#0]
;;;294    					}
;;;295    					else if (TOUCH_InRect(tpX, tpY, BTN2_X, BTN2_Y, BTN2_H, BTN2_W))
00026c  f8bd016c          LDRH     r0,[sp,#0x16c]
000270  236c              MOVS     r3,#0x6c
000272  b281              UXTH     r1,r0
000274  f8bd0190          LDRH     r0,[sp,#0x190]
000278  2278              MOVS     r2,#0x78
00027a  b280              UXTH     r0,r0
00027c  f7fffffe          BL       TOUCH_InRect
000280  b178              CBZ      r0,|L3.674|
;;;296    					{
;;;297    						FormUSB->Btn2.Focus = 0;
000282  f8d90000          LDR      r0,[r9,#0]  ; FormUSB
000286  2100              MOVS     r1,#0
000288  f88010e0          STRB     r1,[r0,#0xe0]
00028c  30cc              ADDS     r0,r0,#0xcc
;;;298    						LCD_DrawButton(&FormUSB->Btn2);
00028e  f7fffffe          BL       LCD_DrawButton
;;;299    
;;;300    						USB_Cable_Config(DISABLE);	/* 关闭U盘 */
000292  2000              MOVS     r0,#0
000294  f7fffffe          BL       USB_Cable_Config
;;;301    						ucUsbOk = 0;
000298  2000              MOVS     r0,#0
                  |L3.666|
00029a  4682              MOV      r10,r0                ;292
00029c  f04f0801          MOV      r8,#1                 ;293
0002a0  e021              B        |L3.742|
                  |L3.674|
;;;302    						fRefresh = 1;
;;;303    					}
;;;304    					else if (TOUCH_InRect(tpX, tpY, BTN3_X, BTN3_Y, BTN3_H, BTN3_W))
0002a2  2078              MOVS     r0,#0x78
0002a4  e9cd4000          STRD     r4,r0,[sp,#0]
0002a8  f8bd016c          LDRH     r0,[sp,#0x16c]
0002ac  2396              MOVS     r3,#0x96
0002ae  b281              UXTH     r1,r0
0002b0  f8bd0190          LDRH     r0,[sp,#0x190]
0002b4  220a              MOVS     r2,#0xa
0002b6  b280              UXTH     r0,r0
0002b8  f7fffffe          BL       TOUCH_InRect
0002bc  b310              CBZ      r0,|L3.772|
;;;305    					{
;;;306    						FormUSB->Btn3.Focus = 0;
0002be  f8d90000          LDR      r0,[r9,#0]  ; FormUSB
0002c2  2100              MOVS     r1,#0
0002c4  464c              MOV      r4,r9
0002c6  f88010f8          STRB     r1,[r0,#0xf8]
0002ca  30e4              ADDS     r0,r0,#0xe4
;;;307    						LCD_DrawButton(&FormUSB->Btn3);
0002cc  f7fffffe          BL       LCD_DrawButton
;;;308    												
;;;309    						if (NAND_Format() == NAND_OK)
0002d0  f7fffffe          BL       NAND_Format
0002d4  b1a0              CBZ      r0,|L3.768|
;;;310    						{
;;;311    							FormUSB->Label4.pCaption = "低级格式化成功";
;;;312    						}
;;;313    						else
;;;314    						{
;;;315    							FormUSB->Label4.pCaption = "低级格式化失败";
0002d6  a060              ADR      r0,|L3.1112|
                  |L3.728|
0002d8  6821              LDR      r1,[r4,#0]  ; FormUSB
;;;316    						}
;;;317    						LCD_DrawLabel(&FormUSB->Label4);
0002da  f8c10088          STR      r0,[r1,#0x88]
0002de  6820              LDR      r0,[r4,#0]  ; FormUSB
0002e0  3078              ADDS     r0,r0,#0x78
0002e2  f7fffffe          BL       LCD_DrawLabel
                  |L3.742|
;;;318    					}					
;;;319    					else	/* 按钮失去焦点 */
;;;320    					{
;;;321    						FormUSB->BtnRet.Focus = 0;
;;;322    						LCD_DrawButton(&FormUSB->BtnRet);
;;;323    
;;;324    						FormUSB->Btn1.Focus = 0;
;;;325    						LCD_DrawButton(&FormUSB->Btn1);
;;;326    
;;;327    						FormUSB->Btn2.Focus = 0;
;;;328    						LCD_DrawButton(&FormUSB->Btn2);
;;;329    					}
;;;330    					break;
;;;331    			}
;;;332    		}
;;;333    
;;;334    		/* 处理按键事件 */
;;;335    		ucKeyCode = bsp_GetKey();
0002e6  f7fffffe          BL       bsp_GetKey
;;;336    		if (ucKeyCode > 0)
0002ea  2800              CMP      r0,#0
0002ec  d04e              BEQ      |L3.908|
;;;337    		{
;;;338    			/* 有键按下 */
;;;339    			switch (ucKeyCode)
0002ee  280d              CMP      r0,#0xd
0002f0  da4c              BGE      |L3.908|
0002f2  2801              CMP      r0,#1
0002f4  d01b              BEQ      |L3.814|
0002f6  2804              CMP      r0,#4
0002f8  d01e              BEQ      |L3.824|
0002fa  2807              CMP      r0,#7
0002fc  d146              BNE      |L3.908|
0002fe  e022              B        |L3.838|
                  |L3.768|
000300  a059              ADR      r0,|L3.1128|
000302  e7e9              B        |L3.728|
                  |L3.772|
000304  f8d90000          LDR      r0,[r9,#0]            ;321  ; FormUSB
000308  2400              MOVS     r4,#0                 ;321
00030a  f8804110          STRB     r4,[r0,#0x110]        ;321
00030e  30fc              ADDS     r0,r0,#0xfc           ;321
000310  f7fffffe          BL       LCD_DrawButton
000314  f8d90000          LDR      r0,[r9,#0]            ;324  ; FormUSB
000318  f88040c8          STRB     r4,[r0,#0xc8]         ;324
00031c  30b4              ADDS     r0,r0,#0xb4           ;324
00031e  f7fffffe          BL       LCD_DrawButton
000322  f8d90000          LDR      r0,[r9,#0]            ;327  ; FormUSB
000326  f88040e0          STRB     r4,[r0,#0xe0]         ;327
                  |L3.810|
00032a  30cc              ADDS     r0,r0,#0xcc           ;327
00032c  e72f              B        |L3.398|
                  |L3.814|
;;;340    			{
;;;341    				case KEY_DOWN_K1:		/* K1键 */
;;;342    					printf("【1 - 移除U盘】\r\n");
00032e  a052              ADR      r0,|L3.1144|
000330  f7fffffe          BL       __2printf
;;;343    					USB_Cable_Config(DISABLE);	/* 关闭U盘 */
000334  2000              MOVS     r0,#0
;;;344    					break;
000336  e003              B        |L3.832|
                  |L3.824|
;;;345    
;;;346    				case KEY_DOWN_K2:		/* K2键按下 */
;;;347    					/* 使能U盘，软件模拟U盘插入 */
;;;348    					printf("【2 - 使能U盘】\r\n");
000338  a054              ADR      r0,|L3.1164|
00033a  f7fffffe          BL       __2printf
;;;349    					USB_Cable_Config(ENABLE);	/* 打开U盘 */
00033e  2001              MOVS     r0,#1
                  |L3.832|
000340  f7fffffe          BL       USB_Cable_Config
000344  e022              B        |L3.908|
                  |L3.838|
;;;350    					break;
;;;351    
;;;352    				case KEY_DOWN_K3:		/* K3键按下 */
;;;353    					/* 重新扫描测试坏块，执行时间很长。 用于NAND 磁盘修复 */
;;;354    					{
;;;355    						uint32_t i;
;;;356    						
;;;357    						FormUSB->Label4.pCaption = buf;
000346  f8d90000          LDR      r0,[r9,#0]  ; FormUSB
00034a  aa02              ADD      r2,sp,#8
;;;358    						FormUSB->Label4.Font = &FormUSB->FontRed;
;;;359    						for (i = 0; i < NAND_BLOCK_COUNT; i++)
00034c  2400              MOVS     r4,#0
00034e  f8c02088          STR      r2,[r0,#0x88]         ;358
000352  f1000210          ADD      r2,r0,#0x10           ;358
000356  f44f6b80          MOV      r11,#0x400
00035a  f8c02084          STR      r2,[r0,#0x84]
                  |L3.862|
;;;360    						{
;;;361    							sprintf(buf, "不要断电,扫描坏块... %d (%d%%)", i, i * 100 / NAND_BLOCK_COUNT);
00035e  2064              MOVS     r0,#0x64
000360  4360              MULS     r0,r4,r0
000362  0a83              LSRS     r3,r0,#10
000364  4622              MOV      r2,r4
000366  a14e              ADR      r1,|L3.1184|
000368  a802              ADD      r0,sp,#8
00036a  f7fffffe          BL       __2sprintf
;;;362    							LCD_DrawLabel(&FormUSB->Label4);
00036e  f8d90000          LDR      r0,[r9,#0]  ; FormUSB
000372  3078              ADDS     r0,r0,#0x78
000374  f7fffffe          BL       LCD_DrawLabel
;;;363    							
;;;364    							if (NAND_ScanBlock(i) == NAND_OK)
000378  4620              MOV      r0,r4
00037a  f7fffffe          BL       NAND_ScanBlock
00037e  b110              CBZ      r0,|L3.902|
;;;365    							{
;;;366    								;
;;;367    							}
;;;368    							else
;;;369    							{
;;;370    								NAND_MarkBadBlock(i);
000380  4620              MOV      r0,r4
000382  f7fffffe          BL       NAND_MarkBadBlock
                  |L3.902|
000386  1c64              ADDS     r4,r4,#1
000388  455c              CMP      r4,r11                ;359
00038a  d3e8              BCC      |L3.862|
                  |L3.908|
00038c  2f00              CMP      r7,#0                 ;184
00038e  f43fae6b          BEQ      |L3.104|
;;;371    							}
;;;372    						}		
;;;373    						;
;;;374    					}
;;;375    					break;
;;;376    
;;;377    				case JOY_DOWN_U:		/* 摇杆UP键按下 */
;;;378    					break;
;;;379    
;;;380    				case JOY_DOWN_D:		/* 摇杆DOWN键按下 */
;;;381    					break;
;;;382    
;;;383    				case JOY_DOWN_L:		/* 摇杆LEFT键按下 */
;;;384    					break;
;;;385    
;;;386    				case JOY_DOWN_R:		/* 摇杆RIGHT键按下 */
;;;387    					break;
;;;388    
;;;389    				case JOY_DOWN_OK:		/* 摇杆OK键按下 */
;;;390    					break;
;;;391    
;;;392    				default:
;;;393    					break;
;;;394    			}
;;;395    		}
;;;396    	}
;;;397    
;;;398    	USB_Cable_Config(DISABLE);	/* 关闭U盘 */
000392  2000              MOVS     r0,#0
000394  f7fffffe          BL       USB_Cable_Config
;;;399    }
000398  b06b              ADD      sp,sp,#0x1ac
00039a  e8bd8ff0          POP      {r4-r11,pc}
;;;400    
                          ENDP

00039e  0000              DCW      0x0000
                  |L3.928|
                          DCD      ||.data||
                  |L3.932|
0003a4  4e414e44          DCB      "NAND_Init() Error! \r\n",0
0003a8  5f496e69
0003ac  74282920
0003b0  4572726f
0003b4  7221200d
0003b8  0a00    
0003ba  00                DCB      0
0003bb  00                DCB      0
                  |L3.956|
0003bc  53746172          DCB      "Start Format(Low Level) NAND Flash......\r\n",0
0003c0  7420466f
0003c4  726d6174
0003c8  284c6f77
0003cc  204c6576
0003d0  656c2920
0003d4  4e414e44
0003d8  20466c61
0003dc  73682e2e
0003e0  2e2e2e2e
0003e4  0d0a00  
0003e7  00                DCB      0
                  |L3.1000|
0003e8  4e414e44          DCB      "NAND Flash Format Ok\r\n",0
0003ec  20466c61
0003f0  73682046
0003f4  6f726d61
0003f8  74204f6b
0003fc  0d0a00  
0003ff  00                DCB      0
                  |L3.1024|
000400  4e414e44          DCB      "NAND_Init() Ok\r\n",0
000404  5f496e69
000408  74282920
00040c  4f6b0d0a
000410  00      
000411  00                DCB      0
000412  00                DCB      0
000413  00                DCB      0
                  |L3.1044|
000414  4f6b2000          DCB      "Ok ",0
                  |L3.1048|
000418  45727200          DCB      "Err",0
                  |L3.1052|
00041c  4f4b2c20          DCB      "OK, %s, Bad=%d, Used=%d, Free=%d",0
000420  25732c20
000424  4261643d
000428  25642c20
00042c  55736564
000430  3d25642c
000434  20467265
000438  653d2564
00043c  00      
00043d  00                DCB      0
00043e  00                DCB      0
00043f  00                DCB      0
                  |L3.1088|
000440  d2d1b4f2          DCB      210,209,180,242,191,170," ",0
000444  bfaa2000
                  |L3.1096|
000448  d2d1b9d8          DCB      210,209,185,216,177,213,0
00044c  b1d500  
00044f  00                DCB      0
                  |L3.1104|
                          DCD      g_LcdHeight
                  |L3.1108|
                          DCD      g_LcdWidth
                  |L3.1112|
000458  b5cdbcb6          DCB      181,205,188,182,184,241,202,189,187,175,202,167,176,220,0
00045c  b8f1cabd
000460  bbafcaa7
000464  b0dc00  
000467  00                DCB      0
                  |L3.1128|
000468  b5cdbcb6          DCB      181,205,188,182,184,241,202,189,187,175,179,201,185,166,0
00046c  b8f1cabd
000470  bbafb3c9
000474  b9a600  
000477  00                DCB      0
                  |L3.1144|
000478  a1be3120          DCB      161,190,"1 - ",210,198,179,253,"U",197,204,161,191,"\r\n"
00047c  2d20d2c6
000480  b3fd55c5
000484  cca1bf0d
000488  0a      
000489  00                DCB      0
00048a  00                DCB      0
00048b  00                DCB      0
                  |L3.1164|
00048c  a1be3220          DCB      161,190,"2 - ",202,185,196,220,"U",197,204,161,191,"\r\n"
000490  2d20cab9
000494  c4dc55c5
000498  cca1bf0d
00049c  0a      
00049d  00                DCB      0
00049e  00                DCB      0
00049f  00                DCB      0
                  |L3.1184|
0004a0  b2bbd2aa          DCB      178,187,210,170,182,207,181,231,",",201,168,195,232,187,181
0004a4  b6cfb5e7
0004a8  2cc9a8c3
0004ac  e8bbb5  
0004af  bfe92e2e          DCB      191,233,"... %d (%d%%)",0
0004b3  2e202564
0004b7  20282564
0004bb  25252900
0004bf  00                DCB      0

                          AREA ||.data||, DATA, ALIGN=2

                  FormUSB
                          DCD      0x00000000

;*** Start embedded assembler ***

#line 1 "..\\..\\User\\app\\src\\usbd_msc_test.c"
	AREA ||.rev16_text||, CODE
	THUMB
	EXPORT |__asm___15_usbd_msc_test_c_761c4946____REV16|
#line 114 "..\\..\\Libraries\\CMSIS\\Include\\core_cmInstr.h"
|__asm___15_usbd_msc_test_c_761c4946____REV16| PROC
#line 115

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.revsh_text||, CODE
	THUMB
	EXPORT |__asm___15_usbd_msc_test_c_761c4946____REVSH|
#line 128
|__asm___15_usbd_msc_test_c_761c4946____REVSH| PROC
#line 129

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
